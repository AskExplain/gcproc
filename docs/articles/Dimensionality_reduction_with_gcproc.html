<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dimensionality reduction with gcproc â€¢ gcproc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dimensionality reduction with gcproc">
<meta property="og:description" content="gcproc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gcproc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aligning_scRNAseq_to_Spatial_Transcriptomics.html">Aligning single cell RNA to histology tissue images</a>
    </li>
    <li>
      <a href="../articles/Dimensionality_reduction_with_gcproc.html">Dimensionality reduction with gcproc</a>
    </li>
    <li>
      <a href="../articles/Recovering_missing_test_data_points.html">Recovering missing test data points</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Dimensionality_reduction_with_gcproc_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dimensionality reduction with gcproc</h1>
            
            <h4 class="date">Compiled: August 28, 2021</h4>
      
      
      <div class="hidden name"><code>Dimensionality_reduction_with_gcproc.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level3">
<h3 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h3>
<p>Generalised Canonical Procrustes (gcproc) is a dimensional reduction technique which encodes samples and features into a smaller subspace that better represents the samples and features in the data. It combines multiple datasets and looks for an improved representation of the data structure shared between datasets. The parameters learned are weights that transforms the original data and can be used to improve projection and embedding techniques such as UMAP (Uniform Manifold Approximation and Projection), and t-SNE (t-distributed Stochastic Neighbourhood Embedding). Encoding the original data improves signal and information quality, where clusters in the projection and embedded space are easier to separate and identify.</p>
</div>
<div id="step-0---prepare-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#step-0---prepare-libraries" class="anchor"></a>Step 0 - Prepare libraries</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gcproc</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Package 'mclust' version 5.4.7
## Type 'citation("mclust")' for citing this R package in publications.</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">irlba</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
</div>
<div id="step-1---prepare-data" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1---prepare-data" class="anchor"></a>Step 1 - Prepare data</h3>
<p>Here, three pancreas datasets are integrated with cells aligned. The Baron, Segerstolpe and Xin datasets are analysed. The top 200 genes are taken, and only acinar, alpha, beta, delta, endothelial, epsilon and gamma cells are selected. These datasets are centered and scaled according to the size of the dataset, ready for analysis via gcproc.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"../../data/pancreas_cell/top_200_genes_pancreas_log_normalised.Rdata"</span><span class="op">)</span>

<span class="va">baron_prepare</span> <span class="op">&lt;-</span> <span class="fu">prepare_data</span><span class="op">(</span><span class="va">baron</span>,log <span class="op">=</span> <span class="cn">F</span>,center <span class="op">=</span> <span class="cn">T</span>,scale.norm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">xin_prepare</span> <span class="op">&lt;-</span> <span class="fu">prepare_data</span><span class="op">(</span><span class="va">xin</span>,log <span class="op">=</span> <span class="cn">F</span>,center <span class="op">=</span> <span class="cn">T</span>,scale.norm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">segerstolpe_prepare</span> <span class="op">&lt;-</span> <span class="fu">prepare_data</span><span class="op">(</span><span class="va">segerstolpe</span>,log <span class="op">=</span> <span class="cn">F</span>,center <span class="op">=</span> <span class="cn">T</span>,scale.norm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="step-2---initialise-gcproc-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2---initialise-gcproc-parameters" class="anchor"></a>Step 2 - Initialise gcproc parameters</h3>
<p>Default parameters are retrieved using the function. The verbose print function for explanation of internal running of the code is turned off. Other default parameters are visible by printing the retrieved config variable. Asking the help function via ?extract_config will provide more information about the parameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">gcproc</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_config.html">extract_config</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## $i_dim
## NULL
## 
## $j_dim
## NULL
## 
## $max_iter
## [1] 150
## 
## $tol
## [1] 0.01
## 
## $verbose
## [1] TRUE
## 
## $init
## [1] "svd-quick"</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">config</span><span class="op">$</span><span class="va">i_dim</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">config</span><span class="op">$</span><span class="va">j_dim</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">config</span><span class="op">$</span><span class="va">verbose</span> <span class="op">&lt;-</span> <span class="cn">F</span></code></pre></div>
</div>
<div id="step-3---run-gcproc-on-all-datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3---run-gcproc-on-all-datasets" class="anchor"></a>Step 3 - Run gcproc on all datasets</h3>
<p>Given gcproc can only align two datasets at a time, Baron is used as a reference for the alignment of Xin and Segerstolpe. They are combined to enrich the encoding of the gene dimension into an informative and shared subspace for the cell axis to be interpreted.</p>
<p>The covariates for the Xin and Segerstolpe datasets are removed by subtracting the difference at the code level. The code is the latent structure each dataset retains that represents the data generating process. By taking the difference between the scRNA-seq and the covariates codes, the relevant structure will be left. With the residual code, it is decoded to recover the covariate adjusted scRNAseq data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">config</span><span class="op">$</span><span class="va">init</span> <span class="op">&lt;-</span> <span class="st">"svd-quick"</span>


<span class="va">gcproc.xin_bar</span> <span class="op">&lt;-</span> <span class="fu">gcproc</span><span class="fu">::</span><span class="fu"><a href="../reference/gcproc.html">gcproc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xin_prepare</span>, 
                                 y <span class="op">=</span> <span class="va">segerstolpe_prepare</span>, 
                                  config <span class="op">=</span> <span class="va">config</span>,
                                 reference <span class="op">=</span> <span class="st">"x"</span>,
                                 fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>i_dim<span class="op">=</span><span class="cn">F</span>,j_dim<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
                                 <span class="op">)</span></code></pre></div>
<pre><code>## Warning in irlba::irlba(cov_x, j_dim, maxit = 10000, verbose = F): You're
## computing too large a percentage of total singular values, use a standard svd
## instead.</code></pre>
<pre><code>## Warning in irlba::irlba(cov_y, j_dim, maxit = 10000, verbose = F): You're
## computing too large a percentage of total singular values, use a standard svd
## instead.</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gcproc.seg_bar</span> <span class="op">&lt;-</span> <span class="fu">gcproc</span><span class="fu">::</span><span class="fu"><a href="../reference/gcproc.html">gcproc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xin_prepare</span>, 
                                  y <span class="op">=</span> <span class="va">baron_prepare</span>, 
                                  config <span class="op">=</span> <span class="va">config</span>,
                                  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>i_dim<span class="op">=</span><span class="cn">F</span>,j_dim<span class="op">=</span><span class="cn">F</span><span class="op">)</span>,
                                 reference <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in irlba::irlba(cov_x, j_dim, maxit = 10000, verbose = F): You're
## computing too large a percentage of total singular values, use a standard svd
## instead.

## Warning in irlba::irlba(cov_x, j_dim, maxit = 10000, verbose = F): You're
## computing too large a percentage of total singular values, use a standard svd
## instead.</code></pre>
</div>
<div id="step-4---plot-dimensionality-reduction" class="section level3">
<h3 class="hasAnchor">
<a href="#step-4---plot-dimensionality-reduction" class="anchor"></a>Step 4 - Plot dimensionality reduction</h3>
<p>The parameters that will transform the [cells] by [gene] space into a [cells] by [k] space, where k is the dimension reduction. Parameters are combined using a summation, similar to how vector spaces are combined.</p>
<p>Notice the clusters representing cell types are visible in each of the first three plots, representing the Baron, Segerstolpe and Xin datasets respectively. The final and fourth plot is the integrated plot of all three datasets - notice that cell types indicated by the coloured points still separate, despite the batch effects of each dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">gcproc.seg_bar</span><span class="op">$</span><span class="va">main.parameters</span><span class="op">$</span><span class="va">u.beta</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">gcproc.seg_bar</span><span class="op">$</span><span class="va">main.parameters</span><span class="op">$</span><span class="va">v.beta</span>

<span class="va">c</span> <span class="op">&lt;-</span> <span class="va">gcproc.xin_bar</span><span class="op">$</span><span class="va">main.parameters</span><span class="op">$</span><span class="va">u.beta</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">gcproc.xin_bar</span><span class="op">$</span><span class="va">main.parameters</span><span class="op">$</span><span class="va">v.beta</span>

<span class="va">projection_gcproc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="va">xin_prepare</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="va">projection_gcproc</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">xin_prepare</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="st">"Xin via gcproc and UMAP"</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_4-1.png" width="576"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="va">segerstolpe_prepare</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="va">projection_gcproc</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="st">"Segerstolpe via gcproc and UMAP"</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_4-2.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="va">baron_prepare</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="va">projection_gcproc</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">baron_prepare</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="st">"Baron via gcproc and UMAP"</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_4-3.png" width="576"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="va">projection_gcproc</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="st">"All 3 datasets via gcproc and UMAP"</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_4-4.png" width="576"></p>
</div>
<div id="step-5---feature-importance-in-dimensionality-reduction" class="section level3">
<h3 class="hasAnchor">
<a href="#step-5---feature-importance-in-dimensionality-reduction" class="anchor"></a>Step 5 - Feature importance in dimensionality reduction</h3>
<p>Given parameters transform the [cell] by [gene] dataset into a [cell] by [k] subspace, it is possible to use only a few genes in the dimension reduction. This involves a matrix product of two matrices: one as a sub-selected data set of a [cell] by [favorite gene set] and another as a learned parameter of weights of [favorite gene set] by [k].</p>
<p>For example, several pancreatic genes that characterize the cell types are visualized via UMAP below. Correspondingly, a UMAP of all genes that are related to ribosomal function are also included and compared with the previous pancreatic gene set. Notice the distinct difference, with only 15 genes used in the favorite pancreatic gene list, and approximately 70 in the ribosomal gene list.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pancreas_genes_of_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INS"</span>, 
                                <span class="st">"SST"</span>, 
                                <span class="st">"PPY"</span>, 
                                <span class="st">"GHRL"</span>, 
                                <span class="st">"GCG"</span>, 
                                <span class="st">"TTR"</span>, 
                                <span class="st">"GAD2"</span>, 
                                <span class="st">"IAPP"</span>, 
                                <span class="st">"CPE"</span>, 
                                <span class="st">"RBP4"</span>, 
                                <span class="st">"CD44"</span>, 
                                <span class="st">"ANXA2"</span>,
                                <span class="st">"SCG2"</span>,
                                <span class="st">"PPP1R1A"</span>,
                                <span class="st">"KRT8"</span><span class="op">)</span>

<span class="va">id_pancreas_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">pancreas_genes_of_interest</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Total length of favourite pancreatic gene list: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">id_pancreas_genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Total length of favourite pancreatic gene list: "
## [2] "15"</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">[</span>,<span class="va">id_pancreas_genes</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="op">(</span><span class="va">projection_gcproc</span><span class="op">[</span><span class="va">id_pancreas_genes</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"All 3 datasets via gcproc and UMAP \n with "</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">id_pancreas_genes</span><span class="op">)</span>,<span class="st">" pancreatic genes"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_5-1.png" width="576"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ribosomal_genes_of_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RPS|RPL"</span><span class="op">)</span>
<span class="va">id_ribosomal_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">ribosomal_genes_of_interest</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Total length of ribosomal gene list: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">id_ribosomal_genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Total length of ribosomal gene list: "
## [2] "68"</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">umap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html">umap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">[</span>,<span class="va">id_ribosomal_genes</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span><span class="op">(</span><span class="va">projection_gcproc</span><span class="op">[</span><span class="va">id_ribosomal_genes</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">layout</span>,
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">baron_prepare</span>,<span class="va">xin_prepare</span>,<span class="va">segerstolpe_prepare</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"UMAP 1"</span>, 
     ylab <span class="op">=</span> <span class="st">"UMAP 2"</span>, 
     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"All 3 datasets via gcproc and UMAP \n with "</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">id_ribosomal_genes</span><span class="op">)</span>,<span class="st">" RPS or RPL genes"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,
     pch<span class="op">=</span><span class="fl">19</span>,
     cex<span class="op">=</span><span class="fl">0.5</span>,
     xaxt<span class="op">=</span><span class="st">"n"</span>,
     yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="Dimensionality_reduction_with_gcproc_files/figure-html/step_5-2.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
